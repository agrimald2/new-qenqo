import{_ as c}from"./CardBox-e1e2cea0.js";import{_ as p}from"./BaseButton-9a3f1db7.js";import{m as l}from"./mdi-66a87996.js";import{_ as r}from"./FormField-f1ea0fce.js";import{_ as i}from"./FormControl-587b9277.js";import{r as u,o as y,c as h,w as d,a as m,j as f,t as _,b as n,u as s}from"./app-9f2eb8dd.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./colors-ea023820.js";import"./BaseIcon-9a2ca4ad.js";import"./main-4957fc0e.js";const P={props:["activePlan"],data(){return{active_students:[],payment_methods:[],payment:{payment_method:"",total_payed:"",student_id:"",active_plan_id:this.activePlan.id},selectedPaymentMethod:[],selectedStudent:[]}},components:[],methods:{fetchActivePlanStudents(){m.get("/api/activePlans/"+this.activePlan.id+"/students").then(e=>{this.active_students=e.data,console.dir(this.active_students)}).catch(e=>{console.error(e)})},fetchPaymentMethods(){m.get("/api/getPaymentMethods").then(e=>{this.payment_methods=e.data}).catch(e=>{console.error(e)})},async addPayment(){this.payment.payment_method=this.selectedPaymentMethod.value,this.payment.student_id=this.selectedStudent.value;try{let e=await m.post("/api/activePlanPayment",this.payment);if(e.status===201)this.$emit("payment-added");else throw new Error(`Request failed with status code ${e.status}`)}catch(e){console.log("Add payment"),console.error(e)}}},mounted(){this.fetchActivePlanStudents(),this.fetchPaymentMethods()}},U=Object.assign(P,{__name:"Create",emits:["family-created"],setup(e,{emit:v}){return u(""),(a,o)=>(y(),h(c,{title:"Pagar",hasCancel:!0,class:"bg-gray-500 slide-in-top my-2"},{default:d(()=>[f(" Faltan S/"+_(e.activePlan.total-e.activePlan.total_payed)+" ",1),n(r,{label:"Alumno"},{default:d(()=>[n(i,{icon:s(l),type:"select",options:a.active_students.map(t=>({label:t.name,value:t.id})),modelValue:a.selectedStudent,"onUpdate:modelValue":o[0]||(o[0]=t=>a.selectedStudent=t)},null,8,["icon","options","modelValue"])]),_:1}),n(r,{label:"Pago"},{default:d(()=>[n(i,{icon:s(l),type:"select",options:a.payment_methods.map(t=>({label:t.name,value:t.name})),modelValue:a.selectedPaymentMethod,"onUpdate:modelValue":o[1]||(o[1]=t=>a.selectedPaymentMethod=t)},null,8,["icon","options","modelValue"]),n(i,{icon:s(l),placeholder:"Total a Pagar",modelValue:a.payment.total_payed,"onUpdate:modelValue":o[2]||(o[2]=t=>a.payment.total_payed=t),type:"number"},null,8,["icon","modelValue"])]),_:1}),n(p,{icon:s(l),label:"Pagar",class:"bg-green-300",target:"_blank","rounded-full":"",color:"",onClick:a.addPayment},null,8,["icon","onClick"])]),_:1}))}});export{U as default};
