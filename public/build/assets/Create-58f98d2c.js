import{_ as c}from"./CardBox-51675e1f.js";import{_ as u}from"./BaseButton-6f77bb6b.js";import{m as l}from"./mdi-a7659b7a.js";import{_ as r}from"./FormField-0061d509.js";import{_ as d}from"./FormControl-56600163.js";import{r as p,o as y,c as h,w as i,a as m,j as f,t as _,b as o,u as s}from"./app-1b5559ad.js";import"./main-a396d137.js";const P={props:["activePlan"],data(){return{active_students:[],payment_methods:[],payment:{payment_method:"",total_payed:"",student_id:"",active_plan_id:this.activePlan.id},selectedPaymentMethod:[],selectedStudent:[]}},components:[],methods:{fetchActivePlanStudents(){m.get("/api/activePlans/"+this.activePlan.id+"/students").then(e=>{this.active_students=e.data,console.dir(this.active_students)}).catch(e=>{console.error(e)})},fetchPaymentMethods(){m.get("/api/getPaymentMethods").then(e=>{this.payment_methods=e.data}).catch(e=>{console.error(e)})},async addPayment(){this.payment.payment_method=this.selectedPaymentMethod.value,this.payment.student_id=this.selectedStudent.value;try{let e=await m.post("/api/activePlanPayment",this.payment);if(e.status===201)this.$emit("payment-added");else throw new Error(`Request failed with status code ${e.status}`)}catch(e){console.log("Add payment"),console.error(e)}}},mounted(){this.fetchActivePlanStudents(),this.fetchPaymentMethods()}},$=Object.assign(P,{__name:"Create",emits:["family-created"],setup(e,{emit:v}){return p(""),(a,n)=>(y(),h(c,{title:"Pagar",hasCancel:!0,class:"bg-gray-500 slide-in-top my-2"},{default:i(()=>[f(" Faltan S/"+_(e.activePlan.total-e.activePlan.total_payed)+" ",1),o(r,{label:"Alumno"},{default:i(()=>[o(d,{icon:s(l),type:"select",options:a.active_students.map(t=>({label:t.name,value:t.id})),modelValue:a.selectedStudent,"onUpdate:modelValue":n[0]||(n[0]=t=>a.selectedStudent=t)},null,8,["icon","options","modelValue"])]),_:1}),o(r,{label:"Pago"},{default:i(()=>[o(d,{icon:s(l),type:"select",options:a.payment_methods.map(t=>({label:t.name,value:t.name})),modelValue:a.selectedPaymentMethod,"onUpdate:modelValue":n[1]||(n[1]=t=>a.selectedPaymentMethod=t)},null,8,["icon","options","modelValue"]),o(d,{icon:s(l),placeholder:"Total a Pagar",modelValue:a.payment.total_payed,"onUpdate:modelValue":n[2]||(n[2]=t=>a.payment.total_payed=t),type:"number"},null,8,["icon","modelValue"])]),_:1}),o(u,{icon:s(l),label:"Pagar",class:"bg-green-300",target:"_blank","rounded-full":"",color:"",onClick:a.addPayment},null,8,["icon","onClick"])]),_:1}))}});export{$ as default};
